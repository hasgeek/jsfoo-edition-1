/* client.js */
(function(){function h(a){return a.replace(/\{[\w\.\(\)]+\}/g,function(a){a.replace(/[\{\}]/g,"")})}function i(a,b,c){a=parseInt(a,10);a=(new Date-new Date(a))/1E3;b=[60,60,24];for(c=0;a>b[c];a/=b[c++]);a=~~a;return c===0&&a<10?"now":a+" "+"sec0min0hour0day".split(0)[c]+(a>1?"s":"")+" ago"}function f(){$("#log,#names").height($(window).height()-180)}setInterval(function(){$("time").each(function(){$(this).html(i($(this).attr("data")))});$("section i").remove()},6E4);f();$(window).resize(f);var c=
io.connect(),d=$("#names"),e=$("#log"),g=0;c.on("connect",function(){console.log("Connected")});c.on("names",function(a){d.empty();for(var b in a)a.hasOwnProperty(b)&&d.prepend("<li><u id='li_"+b+"'>"+b+"</u></li>")});c.on("join",function(a){d.prepend("<li><u id='li_"+a+"'>"+a+"</u></li>")});c.on("part",function(a){d.find("#li_"+a).remove()});c.on("nick",function(a,b){d.find("#li_"+a).each(function(){$(this).attr("id","#li_"+b).html(b)})});c.on("topic",function(a){$("#topic").html(a)});c.on("message",
function(a){a instanceof Array||(a=[a]);for(var b=0,c=a.length;b<c;b++)if(!(a[b].time<=g))e.append(h("<p><time data='{time}'>{pretty(time)}</time><u>{from}</u><span>{linkify(text)}</span></p>",a[b])),g=a[b].time;e[0].scrollTop=e[0].scrollHeight})})();