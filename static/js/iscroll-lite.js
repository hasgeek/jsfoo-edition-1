/*!
* iScroll Lite base on iScroll v4.1.6 ~ Copyright (c) 2011 Matteo Spinelli, http://cubiq.org
* Released under MIT license, http://cubiq.org/license
*/
(function(e,o,v){var j=Math,g=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in e?"O":"";/android/gi.test(navigator.appVersion);var k=/iphone|ipad/gi.test(navigator.appVersion),w=/playbook/gi.test(navigator.appVersion),x=/hp-tablet/gi.test(navigator.appVersion),r="WebKitCSSMatrix"in e&&"m11"in new WebKitCSSMatrix,i="ontouchstart"in e&&!x,y=g+"Transform"in o.documentElement.style,z=k||w,A=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(a){return setTimeout(a,17)}}(),s=e.cancelRequestAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout,p="onorientationchange"in e?"orientationchange":"resize",q=i?"touchstart":"mousedown",l=i?"touchmove":"mousemove",m=i?"touchend":"mouseup",n=i?"touchcancel":"mouseup",t="translate"+(r?"3d(":"("),u=r?",0)":")",k=function(a,c){var b;this.wrapper="object"==typeof a?a:o.getElementById(a);this.wrapper.style.overflow="hidden";this.scroller=this.wrapper.children[0];this.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null};for(b in c)this.options[b]=c[b];this.x=this.options.x;this.y=this.options.y;this.options.useTransform=y?this.options.useTransform:!1;this.options.hScrollbar=this.options.hScroll&&this.options.hScrollbar;this.options.vScrollbar=this.options.vScroll&&this.options.vScrollbar;this.options.useTransition=z&&this.options.useTransition;this.scroller.style[g+"TransitionProperty"]=this.options.useTransform?"-"+g.toLowerCase()+"-transform":"top left";this.scroller.style[g+"TransitionDuration"]="0";this.scroller.style[g+"TransformOrigin"]="0 0";this.options.useTransition&&(this.scroller.style[g+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)");this.options.useTransform?this.scroller.style[g+"Transform"]=t+this.x+"px,"+this.y+"px"+u:this.scroller.style.cssText+=";position:absolute;top:"+this.y+"px;left:"+this.x+"px";this.refresh();this._bind(p,e);this._bind(q);i||this._bind("mouseout",this.wrapper)};k.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,handleEvent:function(a){switch(a.type){case q:if(!i&&0!==a.button)break;this._start(a);break;case l:this._move(a);break;case m:case n:this._end(a);break;case p:this._resize();break;case "mouseout":this._mouseout(a);break;case "webkitTransitionEnd":this._transitionEnd(a)}},_resize:function(){this.refresh()},_pos:function(a,c){a=this.hScroll?a:0;c=this.vScroll?c:0;this.options.useTransform?this.scroller.style[g+"Transform"]=t+a+"px,"+c+"px"+u+" scale("+this.scale+")":(a>>=0,c>>=0,this.scroller.style.left=a+"px",this.scroller.style.top=c+"px");this.x=a;this.y=c},_start:function(a){var c=i?a.touches[0]:a,b,f;if(this.enabled){this.options.onBeforeScrollStart&&this.options.onBeforeScrollStart.call(this,a);this.options.useTransition&&this._transitionTime(0);this.zoomed=this.animating=this.moved=!1;this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;if(this.options.momentum&&(this.options.useTransform?(b=getComputedStyle(this.scroller,null)[g+"Transform"].replace(/[^0-9-.,]/g,"").split(","),f=1*b[4],b=1*b[5]):(f=1*getComputedStyle(this.scroller,null).left.replace(/[^0-9-]/g,""),b=1*getComputedStyle(this.scroller,null).top.replace(/[^0-9-]/g,"")),f!=this.x||b!=this.y))this.options.useTransition?this._unbind("webkitTransitionEnd"):s(this.aniTime),this.steps=[],this._pos(f,b);this.startX=this.x;this.startY=this.y;this.pointX=c.pageX;this.pointY=c.pageY;this.startTime=a.timeStamp||Date.now();this.options.onScrollStart&&this.options.onScrollStart.call(this,a);this._bind(l);this._bind(m);this._bind(n)}},_move:function(a){var c=i?a.touches[0]:a,b=c.pageX-this.pointX,f=c.pageY-this.pointY,d=this.x+b,h=this.y+f,e=a.timeStamp||Date.now();this.options.onBeforeScrollMove&&this.options.onBeforeScrollMove.call(this,a);this.pointX=c.pageX;this.pointY=c.pageY;if(0<d||d<this.maxScrollX)d=this.options.bounce?this.x+b/2:0<=d||0<=this.maxScrollX?0:this.maxScrollX;if(0<h||h<this.maxScrollY)h=this.options.bounce?this.y+f/2:0<=h||0<=this.maxScrollY?0:this.maxScrollY;this.distX+=b;this.distY+=f;this.absDistX=j.abs(this.distX);this.absDistY=j.abs(this.distY);if(!(6>this.absDistX&&6>this.absDistY)){if(this.options.lockDirection)if(this.absDistX>this.absDistY+5)h=this.y,f=0;else if(this.absDistY>this.absDistX+5)d=this.x,b=0;this.moved=!0;this._pos(d,h);this.dirX=0<b?-1:0>b?1:0;this.dirY=0<f?-1:0>f?1:0;if(300<e-this.startTime)this.startTime=e,this.startX=this.x,this.startY=this.y;this.options.onScrollMove&&this.options.onScrollMove.call(this,a)}},_end:function(a){if(!(i&&0!=a.touches.length)){var c=i?a.changedTouches[0]:a,b,f,d={dist:0,time:0},h={dist:0,time:0},e=(a.timeStamp||Date.now())-this.startTime;b=this.x;f=this.y;this._unbind(l);this._unbind(m);this._unbind(n);this.options.onBeforeScrollEnd&&this.options.onBeforeScrollEnd.call(this,a);if(this.moved){if(300>e&&this.options.momentum){d=b?this._momentum(b-this.startX,e,-this.x,this.scrollerW-this.wrapperW+this.x,this.options.bounce?this.wrapperW:0):d;h=f?this._momentum(f-this.startY,e,-this.y,0>this.maxScrollY?this.scrollerH-this.wrapperH+this.y:0,this.options.bounce?this.wrapperH:0):h;b=this.x+d.dist;f=this.y+h.dist;if(0<this.x&&0<b||this.x<this.maxScrollX&&b<this.maxScrollX)d={dist:0,time:0};if(0<this.y&&0<f||this.y<this.maxScrollY&&f<this.maxScrollY)h={dist:0,time:0}}d.dist||h.dist?(c=j.max(j.max(d.time,h.time),10),this.scrollTo(b>>0,f>>0,c)):this._resetPos(200)}else{if(i){for(b=c.target;1!=b.nodeType;)b=b.parentNode;if("SELECT"!=b.tagName&&"INPUT"!=b.tagName&&"TEXTAREA"!=b.tagName)f=o.createEvent("MouseEvents"),f.initMouseEvent("click",!0,!0,a.view,1,c.screenX,c.screenY,c.clientX,c.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null),f._fake=!0,b.dispatchEvent(f)}this._resetPos(200)}this.options.onTouchEnd&&this.options.onTouchEnd.call(this,a)}},_resetPos:function(a){var c=0<=this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,b=0<=this.y||0<this.maxScrollY?0:this.y<this.maxScrollY?this.maxScrollY:this.y;if(c==this.x&&b==this.y){if(this.moved)this.options.onScrollEnd&&this.options.onScrollEnd.call(this),this.moved=!1}else this.scrollTo(c,b,a||0)},_mouseout:function(a){var c=a.relatedTarget;if(c)for(;c=c.parentNode;)if(c==this.wrapper)return;this._end(a)},_transitionEnd:function(a){a.target==this.scroller&&(this._unbind("webkitTransitionEnd"),this._startAni())},_startAni:function(){var a=this,c=a.x,b=a.y,f=Date.now(),d,h,e;if(!a.animating)if(a.steps.length){d=a.steps.shift();if(d.x==c&&d.y==b)d.time=0;a.animating=!0;a.moved=!0;a.options.useTransition?(a._transitionTime(d.time),a._pos(d.x,d.y),a.animating=!1,d.time?a._bind("webkitTransitionEnd"):a._resetPos(0)):(e=function(){var g=Date.now();if(g>=f+d.time)a._pos(d.x,d.y),a.animating=!1,a.options.onAnimationEnd&&a.options.onAnimationEnd.call(a),a._startAni();else if(g=(g-f)/d.time-1,h=j.sqrt(1-g*g),g=(d.x-c)*h+c,a._pos(g,(d.y-b)*h+b),a.animating)a.aniTime=A(e)},e())}else a._resetPos(400)},_transitionTime:function(a){this.scroller.style[g+"TransitionDuration"]=a+"ms"},_momentum:function(a,c,b,f,d){var c=j.abs(a)/c,e=c*c/0.0012,g=0,g=0;0<a&&e>b?(b+=d/(6/(6.0E-4*(e/c))),c=c*b/e,e=b):0>a&&e>f&&(f+=d/(6/(6.0E-4*(e/c))),c=c*f/e,e=f);return{dist:e*(0>a?-1:1),time:c/6.0E-4>>0}},_offset:function(a){for(var c=-a.offsetLeft,b=-a.offsetTop;a=a.offsetParent;)c-=a.offsetLeft,b-=a.offsetTop;return{left:c,top:b}},_bind:function(a,c,b){(c||this.scroller).addEventListener(a,this,!!b)},_unbind:function(a,c,b){(c||this.scroller).removeEventListener(a,this,!!b)},destroy:function(){this.scroller.style[g+"Transform"]="";this._unbind(p,e);this._unbind(q);this._unbind(l);this._unbind(m);this._unbind(n);this._unbind("mouseout",this.wrapper);this.options.useTransition&&this._unbind("webkitTransitionEnd");this.options.onDestroy&&this.options.onDestroy.call(this)},refresh:function(){var a;this.wrapperW=this.wrapper.clientWidth;this.wrapperH=this.wrapper.clientHeight;this.scrollerW=this.scroller.offsetWidth;this.scrollerH=this.scroller.offsetHeight;this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH;this.dirY=this.dirX=0;this.hScroll=this.options.hScroll&&0>this.maxScrollX;this.vScroll=this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);a=this._offset(this.wrapper);this.wrapperOffsetLeft=-a.left;this.wrapperOffsetTop=-a.top;this.scroller.style[g+"TransitionDuration"]="0";this._resetPos(200)},scrollTo:function(a,c,b,e){var d=a;this.stop();d.length||(d=[{x:a,y:c,time:b,relative:e}]);for(a=0,c=d.length;a<c;a++){if(d[a].relative)d[a].x=this.x-d[a].x,d[a].y=this.y-d[a].y;this.steps.push({x:d[a].x,y:d[a].y,time:d[a].time||0})}this._startAni()},scrollToElement:function(a,c){var b;if(a=a.nodeType?a:this.scroller.querySelector(a))b=this._offset(a),b.left+=this.wrapperOffsetLeft,b.top+=this.wrapperOffsetTop,b.left=0<b.left?0:b.left<this.maxScrollX?this.maxScrollX:b.left,b.top=0<b.top?0:b.top<this.maxScrollY?this.maxScrollY:b.top,c=c===v?j.max(2*j.abs(b.left),2*j.abs(b.top)):c,this.scrollTo(b.left,b.top,c)},disable:function(){this.stop();this._resetPos(0);this.enabled=!1;this._unbind(l);this._unbind(m);this._unbind(n)},enable:function(){this.enabled=!0},stop:function(){s(this.aniTime);this.steps=[];this.animating=this.moved=!1}};"undefined"!==typeof exports?exports.iScroll=k:e.iScroll=k})(window,document);
